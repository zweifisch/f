#!/bin/sh

file=f/F.php

cat > $file << EOF
<?php

// this file is generated by running ./build

namespace f;

class F
{
	use Fallback;
	use Singleton;
	
EOF

for path in f/*; do
	bname=$(basename "$path")
	fname="${bname%.*}"

	if [ "$fname" = F ] || [ "$fname" = Fallback ] || [ "$fname" = Singleton ]; then
		continue
	fi

	sed -e "/^return/ s/return function\(.*\){/\n\tpublic function $fname\1{/" \
		-e "s/^};/}/" \
		-ne "/^[^<]/ s/.*/\t&/p" < $path >> $file

	echo "* $fname"
done

echo '}' >> $file
